<div class="container mt-3">
  <div class="row m-auto">
    <div class=" col m-auto">
      <div class="row text-center h-100">
        <div class="col-3 pt-5">
          <div class="item d-flex justify-content-center align-items-center">
            <h5>管理員 <%= name %>
            </h5>
          </div>
        </div>
        <div class="col-6 pt-3">
          <h2>協助訂場</h2>
        </div>
        <div class="col-3">
          <div class="item d-flex flex-column">
            <a href="/admin" class="btn btn-secondary mb-2 text-nowrap" style="width: 8vw; min-width: 5rem;">回上頁</a>
            <button class="btn btn-success" style="width: 8vw;min-width: 5rem;">匯出Excel</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <form action="/admin/booking" method="POST">
    <div class="row g-4 mt-1">
      <!-- 會員編號 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="member_id" class="form-label">會員編號</label>
        <input type="text" class="form-control" id="member_id">
      </div>
      <!-- 姓名 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="name" class="form-label">姓名</label>
        <input type="text" class="form-control" id="name">
      </div>
      <!-- 日期 始 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="date_start" class="form-label">從</label>
        <input type="date" class="form-control" id="date_start">
      </div>
      <!-- 日期 末 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="date_end" class="form-label">至</label>
        <input type="date" class="form-control" id="date_end">

      </div>
      <!-- 球場 下拉式-->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="course" class="form-label">球場</label>
        <select class="form-select" aria-label="course">
          <option selected>請選擇球場</option>
          <option value="1">One</option>
          <option value="2">Two</option>
          <option value="3">Three</option>
        </select>
      </div>
      <!-- 球隊 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="team" class="form-label">球隊</label>
        <input type="text" class="form-control" id="team">
      </div>
      <!-- 聯絡人 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="contact_person" class="form-label">聯絡人</label>
        <input type="text" class="form-control" id="contact_person">
      </div>

      <!-- 狀態 下拉式 -->
      <div class="col-6 col-sm-4 col-md-3">
        <label for="contact_person" class="form-label">狀態</label>
        <select class="form-select" aria-label="state">
          <option selected>全部</option>
          <option value="0">未訂場</option>
          <option value="1">已訂場</option>
        </select>
      </div>
    </div>
    <a href="/admin/booking/" class="d-grid btn btn-primary mt-3 m-auto">
      <h5>訂場查詢</h5>
    </a>
  </form>

  <a href="/admin/booking/new" class="d-grid btn btn-primary mt-3 mb-2  m-auto">
    <h5>新增訂場</h5>
  </a>

  <table id="myTable" class="display cell-border responsive nowrap" style="width: 100%;">
    <thead>
      <tr>
        <th>會員編號</th>
        <th>姓名</th>
        <th>日期</th>
        <th>球場</th>
        <th>開球時間_起</th>
        <th>開球時間_迄</th>
        <th>球隊</th>
        <th>組數</th>
        <th>名單</th>
        <th>聯絡人</th>
        <th>聯絡人電話</th>
        <th>訂場狀態</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function () {
    $('#myTable').DataTable({
      // 中文化
      language: {
        url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/zh-HANT.json',
      },
      // 分頁器
      paging: true,
      // 滾軸頁面
      scrollY: 400,
      // 關鍵字搜尋
      searching: false,
      // 排序
      ordering: false,
      // 顯示加載中
      processing: true,
      // 開啟伺服器端分頁
      serverSide: true,

      ajax: {
        url: `http://localhost:3000/admin/api/get_booking`,
        type: 'GET'
      },
      columns: [
        { data: "member_id" },
        { data: "name" },
        { data: "date" },
        { data: "course" },
        { data: "game_begin_start" },
        { data: "game_begin_end" },
        { data: "team" },
        { data: "group" },
        { data: "booking_list" },
        { data: "contact_person" },
        { data: "phone" },
        { data: "booking_state" },
        {
          data: "id",
          render: function (id) {
            const html = ` <div class="d-flex">
                <a href="/admin/booking/${id}/edit" class="btn btn-info">修改</a>
                <form action="/admin/members/${id}?_method=DELETE" method="POST">
                  <button type="submit" class="del-btn btn btn-danger ms-2" onclick="return confirm('是否確定要刪除會員?')">刪除</button>
                </form>
                </div>`
            return html
          }
        }
      ]
    })
  })

</script>